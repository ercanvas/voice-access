(function(){const btn=document.getElementById("micBtn");const commands=window.voiceCommands||{profile:"/profile",about:"/about",home:"/"};const recognition=new(window.SpeechRecognition||window.webkitSpeechRecognition);recognition.lang="en-US";recognition.continuous=false;function playBeep(){const ctx=new(window.AudioContext||window.webkitAudioContext);const oscillator=ctx.createOscillator();const gain=ctx.createGain();oscillator.type="sine";oscillator.frequency.setValueAtTime(800,ctx.currentTime);gain.gain.setValueAtTime(.2,ctx.currentTime);oscillator.connect(gain);gain.connect(ctx.destination);oscillator.start();oscillator.stop(ctx.currentTime+.2)}function speakText(text){const utterance=new SpeechSynthesisUtterance(text);utterance.lang="en-US";window.speechSynthesis.cancel();window.speechSynthesis.speak(utterance)}function startListening(){playBeep();recognition.start();btn.classList.add("listening")}if(btn)btn.addEventListener("click",startListening);recognition.onresult=event=>{const transcript=event.results[0][0].transcript.toLowerCase();for(const cmd in commands){if(transcript.includes(cmd)){window.location.href=commands[cmd];break}}};recognition.onend=()=>{btn.classList.remove("listening")};let lastDirection="";let hasSpokenIntro=false;function handlePointerMove(x,y){if(!hasSpokenIntro){speakText("Move to reach the microphone. Navigation starting.");hasSpokenIntro=true}const btnRect=btn.getBoundingClientRect();const btnCenterX=btnRect.left+btnRect.width/2;const btnCenterY=btnRect.top+btnRect.height/2;const dx=btnCenterX-x;const dy=btnCenterY-y;const absDx=Math.abs(dx);const absDy=Math.abs(dy);let direction="";if(absDx>80||absDy>80){if(absDx>absDy){direction=dx>0?"go right":"go left"}else{direction=dy>0?"go down":"go up"}if(direction!==lastDirection){speakText(direction);lastDirection=direction}}else if(lastDirection!=="found"){speakText("microphone found");lastDirection="found"}}document.addEventListener("mousemove",(e=>{handlePointerMove(e.clientX,e.clientY)}));document.addEventListener("touchmove",(e=>{const touch=e.touches[0];handlePointerMove(touch.clientX,touch.clientY)}));document.addEventListener("keydown",(e=>{if(e.key.toLowerCase()==="m"){speakText("Keyboard key detected");startListening()}}))})();